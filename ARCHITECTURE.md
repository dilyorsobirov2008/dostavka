TELEGRAM MINI APP SUPERMARKET - ARCHITECTURE DIAGRAM
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TELEGRAM USER (MOBILE/DESKTOP)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          TELEGRAM BOT (@BotFather)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ /start â†’ ğŸ›’ Supermarketchani ochish                                 â”‚   â”‚
â”‚  â”‚ Mini App Button â†’ MINI_APP_URL ga yuborish                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  FRONTEND (React + Vite)     â”‚   â”‚  BACKEND (Node.js)       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
    â”‚  â”‚ Header (Logo + Cart)     â”‚â”‚   â”‚  â”‚ Express Server       â”‚â”‚
    â”‚  â”‚ Category Filter          â”‚â”‚   â”‚  â”‚ POST /api/orders     â”‚â”‚
    â”‚  â”‚ Product Grid (4 col)     â”‚â”‚   â”‚  â”‚ Bot Handler (Telegraf)â”‚â”‚
    â”‚  â”‚ Cart Sidebar             â”‚â”‚   â”‚  â”‚ Email/SMS Notif      â”‚â”‚
    â”‚  â”‚ Checkout Form            â”‚â”‚   â”‚  â”‚ Order Database       â”‚â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
    â”‚                              â”‚   â”‚                          â”‚
    â”‚  @telegram-apps/sdk init     â”‚   â”‚  Bot Token: env var      â”‚
    â”‚  TMA UI Kit (Colors)         â”‚   â”‚  Admin ID: env var       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                         â–²
                    â”‚ HTTP POST               â”‚
                    â”‚ /api/orders             â”‚ Send Message
                    â”‚ (Cart + User Data)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


COMPONENT TREE:
================================================================================

App
â”œâ”€â”€ Header
â”‚   â”œâ”€â”€ Logo
â”‚   â”œâ”€â”€ Cart Badge (count)
â”‚   â””â”€â”€ Total Price Display
â”‚
â”œâ”€â”€ Category
â”‚   â”œâ”€â”€ Category Buttons (Mevalar, Sut, Go'sht, Ichimliklar)
â”‚   â””â”€â”€ Search Input
â”‚
â”œâ”€â”€ ProductGrid
â”‚   â””â”€â”€ ProductCard Ã— N
â”‚       â”œâ”€â”€ Image
â”‚       â”œâ”€â”€ Name
â”‚       â”œâ”€â”€ Price
â”‚       â””â”€â”€ Add Button
â”‚
â”œâ”€â”€ Cart (Sidebar)
â”‚   â”œâ”€â”€ Cart Header
â”‚   â”œâ”€â”€ CartItems Ã— N
â”‚   â”‚   â”œâ”€â”€ Item Image
â”‚   â”‚   â”œâ”€â”€ Item Name & Price
â”‚   â”‚   â”œâ”€â”€ Quantity Controls (Â±)
â”‚   â”‚   â””â”€â”€ Remove Button
â”‚   â”œâ”€â”€ Summary (Subtotal, Delivery, Total)
â”‚   â””â”€â”€ Checkout Button
â”‚
â””â”€â”€ Checkout (Modal)
    â”œâ”€â”€ User Info Form
    â”‚   â”œâ”€â”€ Full Name Input
    â”‚   â”œâ”€â”€ Phone Input
    â”‚   â””â”€â”€ Address TextArea
    â”œâ”€â”€ Order Summary
    â”‚   â””â”€â”€ Items List with Prices
    â””â”€â”€ Submit Button


DATA FLOW:
================================================================================

1. USER SELECTS PRODUCT
   ProductCard â†’ addToCart() â†’ App State (cart array)

2. CART UPDATED
   Cart State â†’ Display CartItems â†’ Show Total

3. USER CLICKS CHECKOUT
   Checkout Form â†’ Validates Input â†’ POST /api/orders

4. ORDER SENT TO BACKEND
   Backend receives: {userId, userName, phone, address, items, totalPrice}

5. ADMIN NOTIFIED
   Bot sends message to ADMIN_CHAT_ID with order details

6. SUCCESS MESSAGE
   User sees confirmation, Cart clears


FOLDER STRUCTURE:
================================================================================

supermarket-tma/
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ App.jsx                    â† Main App
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.jsx                 â† Top Bar
â”‚   â”‚   â”‚   â”œâ”€â”€ Category.jsx               â† Category Filter
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductCard.jsx (in App)   â† Product Tile
â”‚   â”‚   â”‚   â”œâ”€â”€ Cart.jsx                   â† Cart Sidebar
â”‚   â”‚   â”‚   â”œâ”€â”€ Checkout.jsx               â† Order Form
â”‚   â”‚   â”‚   â””â”€â”€ Loading.jsx                â† Loading State
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â”‚   â”œâ”€â”€ App.css
â”‚   â”‚   â”‚   â”œâ”€â”€ Category.css
â”‚   â”‚   â”‚   â””â”€â”€ Checkout.css
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ api.js                     â† API calls
â”‚   â”‚   â”‚   â”œâ”€â”€ tmaUtils.js                â† TMA SDK helpers
â”‚   â”‚   â”‚   â””â”€â”€ storage.js                 â† LocalStorage
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ main.jsx
â”‚   â”‚   â”œâ”€â”€ App.jsx (COMBINED)
â”‚   â”‚   â””â”€â”€ index.css
â”‚   â”‚
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”‚
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ bot.js                             â† Main Bot Logic
â”‚   â”‚
â”‚   â”œâ”€â”€ handlers/
â”‚   â”‚   â”œâ”€â”€ orderHandler.js                â† Process Orders
â”‚   â”‚   â””â”€â”€ notificationHandler.js         â† Send Messages
â”‚   â”‚
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ Order.js                       â† Order Schema
â”‚   â”‚   â””â”€â”€ Product.js                     â† Product Schema
â”‚   â”‚
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ .env                               â† Secrets (git ignore!)
â”‚   â”œâ”€â”€ .env.example                       â† Template
â”‚   â””â”€â”€ .gitignore
â”‚
â”œâ”€â”€ README.md
â””â”€â”€ .gitignore


KEY FILES SUMMARY:
================================================================================

Frontend Files Created:
  âœ“ App.jsx             - Main component with state management
  âœ“ Category.jsx        - Category filtering
  âœ“ Cart.jsx            - Shopping cart display
  âœ“ Checkout.jsx        - Order form
  âœ“ App.css             - All styling (Telegram UI Kit style)
  âœ“ vite.config.js      - Vite configuration
  âœ“ package.json        - Dependencies

Backend Files Created:
  âœ“ bot.js              - Express + Telegraf main file
  âœ“ .env.example        - Environment variables template
  âœ“ package.json        - Node dependencies


DEPLOYMENT CHECKLIST:
================================================================================

Frontend:
  â–¡ Build: npm run build
  â–¡ Deploy to: Vercel, Netlify, or custom server
  â–¡ Get HTTPS URL
  â–¡ Update MINI_APP_URL in .env

Backend:
  â–¡ Set environment variables (BOT_TOKEN, ADMIN_CHAT_ID, MINI_APP_URL)
  â–¡ Deploy to: Heroku, Railway, or custom VPS
  â–¡ Webhook URL: https://yourdomain.com/bot{BOT_TOKEN}
  â–¡ Register webhook with Telegram

Bot Setup:
  â–¡ Create bot with @BotFather
  â–¡ Get BOT_TOKEN
  â–¡ Set Menu Button with Mini App
  â–¡ Get Admin's Chat ID
  â–¡ Test in staging environment


SECURITY CONSIDERATIONS:
================================================================================

1. Input Validation
   - Validate all form inputs on frontend AND backend
   - Use regex for phone number validation
   
2. Rate Limiting
   - Limit API requests per user/IP
   - Prevent order spam

3. Environment Variables
   - Never commit .env file
   - Use .env.example as template
   - Rotate BOT_TOKEN if compromised

4. Data Privacy
   - Store only necessary user data
   - Hash sensitive information
   - GDPR compliance

5. HTTPS Only
   - Mini Apps MUST use HTTPS
   - Secure WebApp connection

================================================================================
